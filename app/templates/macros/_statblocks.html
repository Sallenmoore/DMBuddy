{% macro pcstatblock(info) -%}
<form class="statblock-form">
    <div class="row statblock" data-pk="{{info.pk}}" data-category="NPC">
        <div class="column is-full">
            <div class="row">
                <div class="column is-full">
                    <input value="{{info.name}}" name="name" id="name-{{info.pk}}" class="pc-details title" type="text">
                </div>
                <div class="column is-shrink">
                    {% if info.image['url'] %}
                    <div class="image is-large is-rounded-tile">
                        <img src="{{info.image['url']}}" />
                    </div>
                    <a class="button generate-image is-small">Regenerate Image</a>
                    {% else %}
                    <a class="button generate-image">Generate Image</a>
                    {% endif %}
                </div>
                <div class="column is-2">
                    <label for="occupation-{{info.pk}}" class="subtitle">Occupation</label>

                    <input value="{{info.occupation}}" name="occupation" id="occupation-{{info.pk}}" class="pc-details"
                        type="text">

                    <label class="subtitle">Personality</label>
                    {% for k in info.personality %}
                    <input value="{{k}}" name="personality-{{loop.index}}" id="personality-{{info.pk}}-{{loop.index}}"
                        class="pc-details" type="text">
                    {% endfor %}
                    <label class="subtitle">Age</label>
                    <input value="{{info.age}}" name="age" id="age-{{info.pk}}">
                </div>
                <div class="column">
                    <label class="subtitle">Character History</label>
                    <textarea name="backstory" id="backstory-{{info.pk}}"
                        style="min-height:100%">{{info.backstory | safe}}</textarea>
                </div>
            </div>
            <div class="row">
                <div class="column">
                    <label class="attribute">Canon</label>
                    <div class="is-switch">
                        <input value="{{info.canon}}" type="checkbox" id="canon-{{info.pk}}" name="canon" {% if
                            info.canon %} checked {%endif%}>
                        <label for="canon-{{info.pk}}"></label>
                    </div>
                    <hr>
                    <label class="subtitle">Description</label>
                    <textarea name="desc" rows=3 id="desc-{{info.pk}}">{{info.desc | safe}}</textarea>
                    <hr>
                </div>
            </div>
        </div>
        <div class="column is-3">
            <div class="row is-vertical">
                <div class="column" id="character-attributes-{{info.pk}}">
                    <svg height="5" width="100%" class="tapered-rule">
                        <polyline points="0,0 400,2.5 0,5"></polyline>
                    </svg>
                    <div class="row">
                        <div class="column is-4">
                            <label class="attribute">STR</label>
                            <input value={{info['str']}} name="str" id="str-{{info.pk}}" type="number">
                        </div> <!-- ability strength -->
                        <div class="column is-4">
                            <label class="attribute">DEX</label>
                            <input value={{info['dex']}} name="dex" id="dex-{{info.pk}}" type="number">
                        </div> <!-- ability dexterity -->
                        <div class="column is-4">
                            <label class="attribute">CON</label>
                            <input value={{info['con']}} name="con" id="con-{{info.pk}}" type="number">
                        </div> <!-- ability constitution -->
                        <div class="column is-4">
                            <label class="attribute">INT</label>
                            <input value={{info['int']}} name="int" id="int-{{info.pk}}" type="number">
                        </div> <!-- ability intelligence -->
                        <div class="column is-4">
                            <label class="attribute">WIS</label>
                            <input value={{info['wis']}} name="wis" id="wis-{{info.pk}}" type="number">
                        </div>
                        <div class="column is-4">
                            <label class="attribute">CHA</label>
                            <input value={{info['cha']}} </div>
                        </div>
                    </div>
                </div>
                <div class="column" id="character-stats-{{info.pk}}">
                    <svg height="5" width="100%" class="tapered-rule">
                        <polyline points="0,0 400,2.5 0,5"></polyline>
                    </svg>

                    <div class="row">
                        <div class="column is-half is-inline-label">
                            <label class="attribute">Race</label>
                        </div>
                        <div class="column is-half">
                            <input value="{{info.race}}" name="race" id="race-{{info.pk}}" type="text">
                        </div>
                    </div>
                    <div class="row">
                        <div class="column is-half is-inline-label">
                            <label class="attribute">AC</label>
                        </div>
                        <div class="column is-half">
                            <input value="{{info.ac}}" name="ac" id="ac-{{info.pk}}" type="number">
                        </div>
                    </div>
                    <div class="row">
                        <div class="column is-half is-inline-label">
                            <label class="attribute">Hit Points</label>
                        </div>
                        <div class="column is-half">
                            <input value="{{info['hp']}}" name="hp" id="hp-{{info.pk}}" type="number">
                        </div>
                    </div>
                    <div class="row">
                        <div class="column is-half is-inline-label">
                            <label class="attribute">Passive Perception</label>
                        </div>
                        <div class="column is-half">
                            <input value="{{info.passive_perception}}" type="number" disabled>
                        </div>
                    </div>
                    <div class="row">
                        <div class="column is-half is-inline-label">
                            <label class="attribute">Speed</label>
                        </div>
                        <div class="column is-half">
                            {% for k,v in info.speed.items() %}
                            <div class="is-input-group">
                                <span class="input-group-addon">{{k}}</span>
                                <input value="{{v}}" name="speed-{{k}}" id="speed-{{k}}-{{info.pk}}" type="number">
                            </div>
                            {% endfor %}
                        </div>
                    </div>
                    <div class="row">
                        <div class="column is-half is-inline-label">
                            <label class="attribute">Wealth</label>
                        </div>
                        <div class="column is-half">
                            {% for v in info.wealth %}
                            <input value="{{v}}" name="wealth-{{v}}" id="wealth-{{v}}-{{info.pk}}" type="number">
                            {% endfor %}
                        </div>
                    </div>

                </div>
            </div>
        </div>
        <div class="column">
            <div class="row">
                <div class="column">
                    <h3>Resistances and Immunities</h3>
                    <svg height="5" width="100%" class="tapered-rule">
                        <polyline points="0,0 400,2.5 0,5"></polyline>
                    </svg>


                    {% if info.resistances %}
                    {% for r in info.resistances %}
                    <div class="is-input-group">
                        <input value="{{r}}" name="resistances-{{loop.index}}"
                            id="resistances-{{loop.index}}-{{info.pk}}" type="text">
                    </div>
                    {% endfor %}
                    {% else %}
                    No resistances
                    {% endif %}
                </div>
                <div class="column">
                    <h3>Actions and Features</h3>
                    <svg height="5" width="100%" class="tapered-rule">
                        <polyline points="0,0 400,2.5 0,5"></polyline>
                    </svg>


                    {% if info['features'] %}
                    {# <div class="column is-full">
                        <div class="is-select">
                            <select class="feature-select">
                                <option value=""></option>
                                {% for k in info['features'] %}
                                <option value="feature-{{k|slug}}">
                                    {{k}}
                                </option>
                                {% endfor %}
                            </select>
                        </div>
                    </div> #}
                    {% for v in info['features'] %}
                    <div class="is-input-group">
                        <input value="{{r}}" name="features-{{loop.index}}" id="features-{{loop.index}}-{{info.pk}}"
                            type="text">
                    </div>
                    {%endfor %}
                    {% else %}
                    No features
                    {% endif %}
                </div>
            </div>
            <div class="row">
                <div class="column">

                    <h3>Inventory</h3>
                    <svg height="5" width="100%" class="tapered-rule">
                        <polyline points="0,0 400,2.5 0,5"></polyline>
                    </svg>


                    {% if info['inventory'] %}
                    {# <div class="column is-full">
                        <div class="is-select">
                            <select class="inventory-select">
                                <option value=""></option>
                                {% for r in info['inventory'] %}
                                <option value="r.name">
                                    {{r.name}}
                                </option>
                                {%endfor %}
                            </select>
                        </div>
                    </div> #}
                    {% for r in info.inventory %}
                    <div class="is-input-group">
                        <input value="{{r}}" name="inventory-{{loop.index}}" id="inventory-{{loop.index}}-{{info.pk}}"
                            type="text">
                    </div>
                    {%endfor %}
                    {% else %}
                    No inventory
                    {% endif %}
                </div>
                <div class="column">
                    <h3>Spells</h3>
                    <svg height="5" width="100%" class="tapered-rule">
                        <polyline points="0,0 400,2.5 0,5"></polyline>
                    </svg>


                    {% if info.spells %}
                    <div class="row">
                        <div class="column">
                            {% for r in info['spells'] %}
                            <div class="is-input-group">
                                <input value="{{r}}" name="spells-{{loop.index}}" id="spells-{{loop.index}}-{{info.pk}}"
                                    type="text">
                            </div>
                            {%endfor %}
                        </div>
                    </div>
                    {% else %}
                    No spells
                    {% endif %}
                </div>
            </div>
        </div>
    </div>
</form>
{%- endmacro %}

{% macro mobstatblock(info) -%}
<form>
    <div class="row statblock is-vertical mobcard" data-category="Monster" data-pk="{{info['pk']}}">
        <div class="column">
            <h1>{{info['name']}}</h1>
            <p style="font-style: italic;">{{info['desc']}}</p>
        </div>
        <div class="column">
            <div class="row has-spacing">
                <div class="column is-one-quarter">
                    {% if info.get('image') %}
                    <div class="image">
                        <img src="{{info['image']['url']}}" />
                    </div>
                    <a class="button generate-image is-small">Regenerate Image</a>
                    {% else %}
                    <a class="button generate-image">Generate Image</a>
                    {% endif %}
                    <svg height="5" width="100%" class="tapered-rule">
                        <polyline points="0,0 400,2.5 0,5"></polyline>
                    </svg>
                    <div class="top-stats">
                        <ul>
                            <li>
                                <span class="stat">Armor Class</span> {{info['armor_class']}}
                            </li>
                            <li>
                                <span class="stat">Hit Points</span> {{info['hit_points']}}
                            </li>
                            <li>
                                <span class="stat">Speed</span>
                                <ul>
                                    {% for k,v in info['speed'].items() %}
                                    <li>{{k}}: {{v}} </li>
                                    {% endfor %}
                                </ul>
                            </li>
                        </ul>
                        <svg height="5" width="100%" class="tapered-rule">
                            <polyline points="0,0 400,2.5 0,5"></polyline>
                        </svg>
                        <div class="row">
                            <div class="column is-4">
                                <p class="stat">STR</p>
                                <p>{{info['strength']}}</p>
                            </div> <!-- ability strength -->
                            <div class="column is-4">
                                <p class="stat">DEX</p>
                                <p>{{info['dexterity']}}</p>
                            </div> <!-- ability dexterity -->
                            <div class="column is-4">
                                <p class="stat">CON</p>
                                <p>{{info['constitution']}}</p>
                            </div> <!-- ability constitution -->
                            <div class="column is-4">
                                <p class="stat">INT</p>
                                <p>{{info['intelligence']}}</p>
                            </div> <!-- ability intelligence -->
                            <div class="column is-4">
                                <p class="stat">WIS</p>
                                <p>{{info['wisdom']}}</p>
                            </div> <!-- ability wisdom -->
                            <div class="column is-4">
                                <p class="stat">CHA</p>
                                <p>{{info['charisma']}}</p>
                            </div> <!-- ability charisma -->
                        </div> <!-- abilities -->
                        <svg height="5" width="100%" class="tapered-rule">
                            <polyline points="0,0 400,2.5 0,5"></polyline>
                        </svg>
                        <ul>
                            {% if info['resistance'] %}
                            <li>
                                <span class="stat">Damage Immunities</span>
                                {{info['damage_immunities'] }}
                            </li>
                            {% endif %}
                            {% if info['condition_immunities'] %}
                            <li>
                                <span class="stat">Condition Immunities</span>
                                {{info['condition_immunities']}}
                            </li>
                            <li>
                                <span class="stat">Senses</span>
                                {{info['senses']}}
                            </li>
                            {% endif %}
                            {% if info['languages'] %}
                            <li>
                                <span class="stat">Languages</span>
                                {{info['languages']}}
                            </li>
                            {% endif %}
                            {% if info['challenge_rating'] %}
                            <li>
                                <span class="stat">Challenge</span>
                                {{info['challenge_rating']}}
                            </li>
                            {% endif %}
                        </ul>
                    </div>
                    <svg height="5" width="100%" class="tapered-rule">
                        <polyline points="0,0 400,2.5 0,5"></polyline>
                    </svg>
                    <ul>
                        {% for trait in info['traits'] %}
                        <li>
                            <span class="stat">{{trait['title']}}</span> {{trait['description']}}
                        </li>
                        {% endfor %}
                    </ul>
                </div> <!-- section left -->
                <!-- section left -->
                <div class="column">
                    {% if info['actions'] %}
                    <h3>Actions</h3>
                    <ul>
                        {% for action in info['actions'] %}
                        <li>
                            <span class="stat">{{action['name']}}</span>
                            {{action['desc']}}
                            <hr>
                        </li>
                        {% endfor %}
                    </ul>
                    {% endif %}
                    {% if info['reactions'] %}
                    <h3>Reactions</h3>
                    <ul>
                        {% for action in info['reactions'] %}
                        <li>
                            <span class="stat">{{action['name']}}</span>
                            {{action['desc']}}
                        </li>
                        {% endfor %}
                    </ul>
                    {% endif %}
                    {% if info['special_abilities'] %}
                    <h3>Special Abilities</h3>
                    <ul>
                        {% for sp in info['special_abilities'] %}
                        <li>
                            <span class="stat">{{sp['name']}}</span> {{sp['desc']}}
                        </li>
                        {% endfor %}
                    </ul>
                    {% endif %}
                    {% if info['legendary_actions'] %}
                    <h4>Legendary Actions</h4>
                    <ul>
                        {% for sp in info['legendary_actions'] %}
                        <li>
                            <span class="stat">{{sp['name']}}</span> {{sp['desc']}}
                        </li>
                        {% endfor %}
                    </ul>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>
</form>
{%- endmacro %}

{% macro itemstatblock(info) -%}
<form>
    <div class="row statblock is-vertical itemcard" data-category="Item" data-pk="{{info['pk']}}">
        <div class="column">
            <input class="item-details has-text-dark" type="text" name="name" id="item-name" value="{{info['name']}}">
        </div>
        <div class="column">
            <label>Description</label>
            <div class="item-details" id="item-desc" contenteditable>{{info['desc'] | safe}}</div>
        </div>
        <div class="column">
            <div class="image">
                <img src="{{info['image']['url']}}" />
            </div>
            <div class="row">
                <div class="column">
                    <button id="api-item-update" class="button is-primary">Update from API</button>
                </div>
                <div class="column">
                    <button id="get-item-image" class="button is-primary">Get New Image</button>
                </div>
                <div class="column">
                    <label>Image ID</label>
                    <input class="item-details has-text-dark" type="url" name="image-id" id="image-id"
                        value="{{info['image']['id']}}">
                    <label>Image URL</label>
                    <input class="item-details has-text-dark" type="url" name="image-url" id="image-url"
                        value="{{info['image']['url']}}">
                </div>
            </div>
        </div>
    </div>
</form>
{%- endmacro %}

{% macro spellstatblock(info) -%}
<form>
    <div class="row statblock is-vertical spellcard" data-pk="{{info['pk']}}">
        <div class="column">
            <h1>{{info['name']}}</h1>
            <div class="image">
                <img src="{{info['image']['url']}}" />
            </div>
        </div>
        <div class="column">
            <div class="top-stats">
                <ul>
                    <li>
                        <span class="stat">Range</span> {{info['range']}}
                    </li>
                    <li>
                        <span class="stat">Concentration</span> {{info['concentration']}}
                    </li>
                    <li>
                        <span class="stat">Casting Time</span> {{info['casting_time']}}
                    </li>
                </ul>
            </div>
            <svg height="5" width="100%" class="tapered-rule">
                <polyline points="0,0 400,2.5 0,5"></polyline>
            </svg>
            <h5> Description </h5>
            <p style="font-style: italic;">{{info['desc']}}</p>
            <svg height="5" width="100%" class="tapered-rule">
                <polyline points="0,0 400,2.5 0,5"></polyline>
            </svg>
            <h5> Variations </h5>
            <p style="font-style: italic;">{{info['variations']}}</p>
        </div>
    </div>
</form>
{%- endmacro %}

{% macro shopstatblock(info) -%}
<form>
    <div class="panel">
        <div class="row shopcard" data-category="Shop" data-pk="{{info['pk']}}">
            <div class="column">
                <div class="image circle">
                    <img src="{{info['image']['url']}}" />
                </div>
                <h1>{{info['name']}}</h1>
                <p style="font-style: italic;">{{info['shoptype']}}</p>
                <p>Proprietor : {{info['owner']}}</p>
                <ul>
                    {% for item, price in info['inventory'].items() %}
                    <li>
                        {{item}}</span>:{{price}}
                    </li>
                    {% endfor %}
                </ul>
            </div>
        </div>
    </div>
</form>
{%- endmacro %}

{% macro encounterstatblock(info) -%}
<form>
    <div class="panel">
        <div class="row is-vertical encountercard" data-category="Encounter" data-pk="{{info['pk']}}">
            <div class="column">
                <h1>Combatants</h1>
                <ul>
                    {% for combatant in info['enemies'] %}
                    <li>{{combatant}}</li>
                    {% endfor %}
                </ul>
            </div>
            <div class="column">
                <h3>Loot</h3>
                <ul>
                    {% for loot in info['loot'] %}
                    <li>{{loot}}</li>
                    {% endfor %}
                </ul>
            </div>
            <div class="column">
                <h3>Notes</h3>
                <textarea id="encounter-notes">
                {{info.get('notes', '')}}
            </textarea>
            </div>
        </div>
    </div>
</form>
{%- endmacro %}